# Mushroom Phylogeny

This lab on Evolutionary Patterns course has been inspired by [this](https://github.com/iirisarri/PEB_Phylogenomics) guide on phylogenomics.

This document will guide you through phylogenetics pipeline—–allowing you to go from a bunch of sequences to a phylogenetic tree that represents how the sequences are related to each other. The phylogenetic analyses will yield a phylogenetic hypothesis in terms of shared history (tree topology), but also in terms of evolutionary change (branch lengths) and other
interesting parameters such as relative substitution rates between loci, base frequencies, relative substitution frequencies (between different bases), etc.

The phylogenomics pipeline can become very complex, many additional steps might be included (particularly at the satage of dataset assembly!) and some analyses can take weeks to complete. Pipelines are modular, meaning they can (and should) be improved, as well as modified to the particular question at hand.

## Objective and data

The objective of this lab is to use the sequence reads that you generated in conjunction with existing data in GenBank/SILVA for phylogenetic analyses of the mushroom group that you were assigned. This practical can be roken down into several steps:
1) Trimming Sanger sequences and assembling contigs
2) Assembling data sets for each locus based on your own sequences (above) and entries in GenBank/SILVA
3) Phylogenetic analyses of separate and combined data sets, using (a) Parsimony and (b) Bayesian methods 
4) Evaluating the results 

## Programs required

## 1. Trimming Sanger sequences and assembling contigs

The first step is to process the Sanger sequences that you generated. This involves: 
- calling bases/processing a chromatogram 
- trimming poor quality sequence
- merging the forward and reverse read together into a single consensus sequence or contig

We will use [Assseq](https://github.com/andersla/Assseq) for this task which is simple to use. 

Start by downloading your sequences from StudentPortalen (**Documents -> Labs -> Mushroom Phylogeny -> Sanger sequences**). Only download the sequences generated by your group (check these in the Mushrooms&Labelling.xlsx file on StudentPortalen). Next, load the forward and reverse reads in .ab1 format, one sequence at a time in Assseq. Scroll to view the chromatograms. *Do you have good quality sequences?* 

Trim poor quality bases and assemble into a contig (**Assemble -> Reassemble everything with CAP3 external assembler plugin**). You can now edit the consensus sequence (only if necessary) or reverse complement it if it is in the incorrect orientation. Save the consensus sequence (**File -> Save consensus as Fasta**) (be sure to give it a good name - the name of the mushroom and the gene).

*Imp*: Verify that you actually did amplify a mushroom and the correct gene by [BLASTing](https://blast.ncbi.nlm.nih.gov/Blast.cgi) your consensus sequence.
